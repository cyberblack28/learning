<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <title>12.Kubernetes</title>

  <!-- Bootstrap -->
  <link href="../css/bootstrap.min.css" rel="stylesheet">
  <link href="../css/custom.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
  <header id="header">
    <header-title></header-title>
  </header>

  <hr>

  <div class="contents_area">
    <h2>12.Kubernetes</h2>

    <h3>Kubernetesの構築テキスト</h3>

    <h4 class="h4_title">事前作業</h4>

    <ol>
      <li>studentユーザでログインして、rootユーザに変更します。
        <!-- code -->
        <pre class="pre"><code>$ su -
パスワード:tokyoec
#
</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h4 class="h4_title">kindのインストール</h4>

    <ol>
      <li>kindのダウンロード
        <!-- code -->
        <pre class="pre"><code># curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.9.0/kind-linux-amd64
        % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
        Dload  Upload   Total   Spent    Left  Speed
100    97  100    97    0     0    130      0 --:--:-- --:--:-- --:--:--   130
100   642  100   642    0     0    584      0  0:00:01  0:00:01 --:--:--  2268
100 7247k  100 7247k    0     0  1664k      0  0:00:04  0:00:04 --:--:-- 2883k</code></pre>
        <!-- /code/ -->
      </li>
      <li>実行権限の付与
        <!-- code -->
        <pre class="pre"><code># chmod +x ./kind</code></pre>
        <!-- /code/ -->
      </li>
      <li>実行場所にkindを移動
        <!-- code -->
        <pre class="pre"><code># mv ./kind /usr/local/bin</code></pre>
        <!-- /code/ -->
      </li>
      <li>kindコマンドの実行
        <!-- code -->
        <pre class="pre"><code># kind version
kind v0.9.0 go1.15.2 linux/amd64</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h4 class="h4_title">kindでKubernetesクラスタの構築</h4>

    <ol>
      <li>「multinode.yaml」の作成
        <!-- code -->
        <pre class="pre"><code># vim multinode.yaml
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
# 1 control plane node and 3 workers
nodes:
# the control plane node config
- role: control-plane
# the three workers
- role: worker
- role: worker
- role: worker
</code></pre>
        <!-- /code/ -->
      </li>
      <li>Kubernetesクラスタの構築
        <!-- code -->
        <pre class="pre"><code># kind create cluster --name k8s --config multinode.yaml
Creating cluster "k8s" ...
 ? Ensuring node image (kindest/node:v1.19.1) ?
 ? Preparing nodes ? ?Ζ ? ?Ζ
 ? Writing configuration ?
 ? 袴tarting control-plane ?刻?
?? 孤nstalling CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
?? Installing CNI ?
 ? Installing CNI ?

 ? 症nstalling StorageClass ?
 ? Joining worker nodes ?
Set kubectl context to "kind-k8s"
You can now use your cluster with:

kubectl cluster-info --context kind-k8s

Thanks for using kind! ?</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h4 class="h4_title">kubectlコマンドのインストール</h4>

    <ol>
      <li>kubectlコマンドのダウンロード
        <!-- code -->
        <pre class="pre"><code># curl -LO "https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl"
        % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
        Dload  Upload   Total   Spent    Left  Speed
100 38.3M  100 38.3M    0     0  9770k      0  0:00:04  0:00:04 --:--:-- 9770k
</code></pre>
        <!-- /code/ -->
      </li>
      <li>実行権限の付与
        <!-- code -->
        <pre class="pre"><code># chmod +x ./kubectl</code></pre>
        <!-- /code/ -->
      </li>
      <li>実行場所にkubectlを移動
        <!-- code -->
        <pre class="pre"><code># mv ./kubectl /usr/local/bin</code></pre>
        <!-- /code/ -->
      </li>
      <li>kubectlコマンドの実行
        <!-- code -->
        <pre
          class="pre"><code># kubectl version --client
Client Version: version.Info{Major:"1", Minor:"20", GitVersion:"v1.20.1", GitCommit:"c4d752765b3bbac2237bf87cf0b1c2e307844666", GitTreeState:"clean", BuildDate:"2020-12-18T12:09:25Z", GoVersion:"go1.15.5", Compiler:"gc", Platform:"linux/amd64"}</code></pre>
        <!-- /code/ -->
      </li>
      <li>kubectl get nodes
        <!-- code -->
        <pre class="pre"><code># kubectl get nodes
        NAME                STATUS   ROLES    AGE    VERSION
        k8s-control-plane   Ready    master   142m   v1.19.1
        k8s-worker          Ready    &lt;none&gt;   141m   v1.19.1
        k8s-worker2         Ready    &lt;none&gt;   141m   v1.19.1
        k8s-worker3         Ready    &lt;none&gt;   141m   v1.19.1
</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h4 class="h4_title">kubectlコマンド演習</h4>

    <h5 class="h5_title">Pod作成</h5>

    <ol>
      <li>Nginxという名前のNginx Podを作成
        <!-- code -->
        <pre class="pre"><code># kubectl run nginx --image=nginx --restart=Never
pod/nginx created
</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx Podの確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod
NAME    READY   STATUS    RESTARTS   AGE
nginx   1/1     Running   0          2m17s</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx PodのClusterIP確認
        <!-- code -->
        <pre class="pre"><code># kubectl describe pod nginx | grep IP:
IP:           10.244.3.2
  IP:  10.244.3.2</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx Podのアクセス確認
        <!-- code -->
        <pre class="pre"><code># kubectl run busybox --image=busybox --restart=Never -it --rm -- sh
If you don't see a command prompt, try pressing enter.
/ #
# wget -O- 10.244.3.2
Connecting to 10.244.3.2 (10.244.3.2:80)
writing to stdout
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href="http://nginx.org/"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href="http://nginx.com/"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
-                    100% |*************************************************************************************************************|   612  0:00:00 ETA
written to stdout
/ # exit
pod "busybox" deleted
</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx Podの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete pod nginx
pod "nginx" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>削除されたことを確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod
No resources found in default namespace.</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx Podをyamlを生成して、そのyamlから作成
        <!-- code -->
        <pre
          class="pre"><code># kubectl run nginx --image=nginx --restart=Never --dry-run=client -o yaml > nginx.yaml</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># cat nginx.yaml
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    run: nginx
  name: nginx
spec:
  containers:
  - image: nginx
    name: nginx
    resources: {}
  dnsPolicy: ClusterFirst
  restartPolicy: Never
status: {}</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl create -f nginx.yaml
pod/nginx created</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl get pod nginx
NAME    READY   STATUS    RESTARTS   AGE
nginx   1/1     Running   0          45s</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx Podの詳細確認
        <!-- code -->
        <pre class="pre"><code># kubectl describe pod nginx
Name:         nginx
Namespace:    default
Priority:     0
Node:         k8s-worker2/172.18.0.2
Start Time:   Tue, 22 Dec 2020 21:33:04 -0500
Labels:       run=nginx
Annotations:  &lt;none&gt;
Status:       Running
IP:           10.244.2.4
IPs:
  IP:  10.244.2.4
Containers:
  nginx:
    Container ID:   containerd://4f241c50e7082668087ef8d568773fe8db5a04d000323523340a5f1d8792977e
    Image:          nginx
    Image ID:       docker.io/library/nginx@sha256:4cf620a5c81390ee209398ecc18e5fb9dd0f5155cd82adcbae532fec94006fb9
    Port:           &lt;none&gt;
    Host Port:      &lt;none&gt;
    State:          Running
      Started:      Tue, 22 Dec 2020 21:33:07 -0500
    Ready:          True
    Restart Count:  0
    Environment:    &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-w6w42 (ro)
Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
Volumes:
  default-token-w6w42:
    Type:        Secret (a volume populated by a Secret)
    SecretName:  default-token-w6w42
    Optional:    false
QoS Class:       BestEffort
Node-Selectors:  &lt;none&gt;
Tolerations:     node.kubernetes.io/not-ready:NoExecute op=Exists for 300s
                 node.kubernetes.io/unreachable:NoExecute op=Exists for 300s
Events:
  Type    Reason     Age    From               Message
  ----    ------     ----   ----               -------
  Normal  Scheduled  2m27s  default-scheduler  Successfully assigned default/nginx to k8s-worker2
  Normal  Pulling    2m26s  kubelet            Pulling image "nginx"
  Normal  Pulled     2m24s  kubelet            Successfully pulled image "nginx" in 1.899103542s
  Normal  Created    2m24s  kubelet            Created container nginx
  Normal  Started    2m24s  kubelet            Started container nginx</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx Podの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete pod nginx
pod "nginx" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>削除されたことを確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod
No resources found in default namespace.</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h5 class="h5_title">Label作成</h5>

    <ol>
      <li>nginxという名前でapp=v1というラベルを持つNginx Podを作成
        <!-- code -->
        <pre class="pre"><code># kubectl run nginx --image=nginx --restart=Never --labels=app=v1
pod/nginx created
</code></pre>
        <!-- /code/ -->
      </li>
      <li>すべてのPodラベル確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod --show-labels
NAME    READY   STATUS    RESTARTS   AGE   LABELS
nginx   1/1     Running   0          49s   app=v1
</code></pre>
        <!-- /code/ -->
      </li>
      <li>app=v2にラベル名を変更
        <!-- code -->
        <pre class="pre"><code># kubectl get pod --show-labels
pod/nginx labeled</code></pre>
        <!-- /code/ -->
      </li>
      <li>appラベルを持つPodのみ確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod -L app
NAME    READY   STATUS    RESTARTS   AGE   APP
nginx   1/1     Running   0          11m   v2</code></pre>
        <!-- /code/ -->
      </li>
      <li>app=v2ラベルを持つPodのみ確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod -l app=v2
NAME    READY   STATUS    RESTARTS   AGE
nginx   1/1     Running   0          11m</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx Podの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete pod nginx
pod "nginx" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>削除されたことを確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod
No resources found in default namespace.</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h5 class="h5_title">Deployment作成</h5>

    <ol>
      <li>nginxという名前でバージョン1.19.1のNginx,レプリカ数2のDeploymentの作成
        <!-- code -->
        <pre
          class="pre"><code># kubectl create deployment nginx  --image=nginx:1.19.1 --dry-run=client -o yaml > nginx_dep.yaml</code></pre>
        <!-- /code/ -->
        nginx_dep.yamlのreplicasを1から2へ変更
        <!-- code -->
        <pre
          class="pre"><code># vim nginx_dep.yaml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: apps/v1
kind: Deployment
metadata:
  creationTimestamp: null
  labels:
    app: nginx
  name: nginx
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx
  strategy: {}
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: nginx
    spec:
      containers:
      - image: nginx:1.19.1
        name: nginx
        resources: {}
status: {}
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------</code></pre>
        <!-- /code/ -->
        nginx_dep.yamlからDeploymentを作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f nginx_dep.yaml
deployment.apps/nginx created</code></pre>
        <!-- /code/ -->
      </li>
      <li>Podが2個生成されていることを確認
        <!-- code -->
        <pre class="pre"><code># kubectl create -f nginx_dep.yaml
deployment.apps/nginx created</code></pre>
        <!-- /code/ -->
      </li>
      <li>1podを削除して、セルフヒーリングを確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod
NAME                     READY   STATUS    RESTARTS   AGE
nginx-69576c95db-hlm9l   1/1     Running   0          4m46s
nginx-69576c95db-zrhhc   1/1     Running   0          4m46s</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl delete pod nginx-69576c95db-hlm9l
NAME                     READY   STATUS    RESTARTS   AGE
nginx-69576c95db-hlm9l   1/1     Running   0          4m46s
nginx-69576c95db-zrhhc   1/1     Running   0          4m46s</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl delete pod nginx-69576c95db-hlm9l
pod "nginx-69576c95db-hlm9l" deleted</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl get pod
NAME                     READY   STATUS    RESTARTS   AGE
nginx-69576c95db-ch8pp   1/1     Running   0          44s
nginx-69576c95db-zrhhc   1/1     Running   0          6m41s</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginxを1.19.2にアップデート
        <!-- code -->
        <pre class="pre"><code># kubectl set image deployment nginx nginx=nginx:1.19.2
deployment.apps/nginx image updated</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl describe deployment nginx
Name:                   nginx
Namespace:              default
CreationTimestamp:      Tue, 22 Dec 2020 23:55:01 -0500
Labels:                 app=nginx
Annotations:            deployment.kubernetes.io/revision: 2
Selector:               app=nginx
Replicas:               2 desired | 2 updated | 2 total | 2 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  app=nginx
  Containers:
   nginx:
    Image:        nginx:1.19.2
    Port:         &lt;none&gt;
    Host Port:    &lt;none&gt;
    Environment:  &lt;none&gt;
    Mounts:       &lt;none&gt;
  Volumes:        &lt;none&gt;
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  &lt;none&gt;
NewReplicaSet:   nginx-c7598c4c (2/2 replicas created)
Events:
  Type    Reason             Age    From                   Message
  ----    ------             ----   ----                   -------
  Normal  ScalingReplicaSet  8m37s  deployment-controller  Scaled up replica set nginx-69576c95db to 2
  Normal  ScalingReplicaSet  49s    deployment-controller  Scaled up replica set nginx-c7598c4c to 1
  Normal  ScalingReplicaSet  33s    deployment-controller  Scaled down replica set nginx-69576c95db to 1
  Normal  ScalingReplicaSet  33s    deployment-controller  Scaled up replica set nginx-c7598c4c to 2
  Normal  ScalingReplicaSet  15s    deployment-controller  Scaled down replica set nginx-69576c95db to 0</code></pre>
        <!-- /code/ -->
      </li>
      <li>Revision内容の確認
        <!-- code -->
        <pre class="pre"><code># kubectl rollout history deployment nginx
deployment.apps/nginx
REVISION  CHANGE-CAUSE
1         &lt;none&gt;
2         &lt;none&gt;</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl rollout history deployment nginx --revision=1
deployment.apps/nginx with revision #1
Pod Template:
  Labels:       app=nginx
        pod-template-hash=69576c95db
  Containers:
   nginx:
    Image:      nginx:1.19.1
    Port:       &lt;none&gt;
    Host Port:  &lt;none&gt;
    Environment:        &lt;none&gt;
    Mounts:     &lt;none&gt;
  Volumes:      &lt;none&gt;</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl rollout history deployment nginx --revision=2
deployment.apps/nginx with revision #2
Pod Template:
  Labels:       app=nginx
        pod-template-hash=c7598c4c
  Containers:
   nginx:
    Image:      nginx:1.19.2
    Port:       &lt;none&gt;
    Host Port:  &lt;none&gt;
    Environment:        &lt;none&gt;
    Mounts:     &lt;none&gt;
  Volumes:      &lt;none&gt;</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginxのバージョンを1.19.1にロールバック
        <!-- code -->
        <pre class="pre"><code># kubectl rollout undo deployment nginx
deployment.apps/nginx rolled back</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre
          class="pre"><code># kubectl describe deployment nginx
Name:                   nginx
Namespace:              default
CreationTimestamp:      Tue, 22 Dec 2020 23:55:01 -0500
Labels:                 app=nginx
Annotations:            deployment.kubernetes.io/revision: 3
Selector:               app=nginx
Replicas:               2 desired | 2 updated | 2 total | 2 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  app=nginx
  Containers:
   nginx:
    Image:        nginx:1.19.1
    Port:         &lt;none&gt;
    Host Port:    &lt;none&gt;
    Environment:  &lt;none&gt;
    Mounts:       &lt;none&gt;
  Volumes:        &lt;none&gt;
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  &lt;none&gt;
NewReplicaSet:   nginx-69576c95db (2/2 replicas created)
Events:
  Type    Reason             Age                From                   Message
  ----    ------             ----               ----                   -------
  Normal  ScalingReplicaSet  28m                deployment-controller  Scaled up replica set nginx-c7598c4c to 1
  Normal  ScalingReplicaSet  28m                deployment-controller  Scaled down replica set nginx-69576c95db to 1
  Normal  ScalingReplicaSet  28m                deployment-controller  Scaled up replica set nginx-c7598c4c to 2
  Normal  ScalingReplicaSet  28m                deployment-controller  Scaled down replica set nginx-69576c95db to 0
  Normal  ScalingReplicaSet  47s                deployment-controller  Scaled up replica set nginx-69576c95db to 1
  Normal  ScalingReplicaSet  46s (x2 over 36m)  deployment-controller  Scaled up replica set nginx-69576c95db to 2
  Normal  ScalingReplicaSet  46s                deployment-controller  Scaled down replica set nginx-c7598c4c to 1
  Normal  ScalingReplicaSet  45s                deployment-controller  Scaled down replica set nginx-c7598c4c to 0</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginxのバージョンを revision 2 の nginx 1.19.2 にロールバック
        <!-- code -->
        <pre class="pre"><code># kubectl rollout undo deployment nginx --to-revision=2
deployment.apps/nginx rolled back</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre
          class="pre"><code># kubectl describe deployment nginx
Name:                   nginx
Namespace:              default
CreationTimestamp:      Tue, 22 Dec 2020 23:55:01 -0500
Labels:                 app=nginx
Annotations:            deployment.kubernetes.io/revision: 4
Selector:               app=nginx
Replicas:               2 desired | 2 updated | 2 total | 2 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  app=nginx
  Containers:
   nginx:
    Image:        nginx:1.19.2
    Port:         &lt;none&gt;
    Host Port:    &lt;none&gt;
    Environment:  &lt;none&gt;
    Mounts:       &lt;none&gt;
  Volumes:        &lt;none&gt;
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  &lt;none&gt;
NewReplicaSet:   nginx-c7598c4c (2/2 replicas created)
Events:
  Type    Reason             Age                  From                   Message
  ----    ------             ----                 ----                   -------
  Normal  ScalingReplicaSet  3m54s                deployment-controller  Scaled up replica set nginx-69576c95db to 1
  Normal  ScalingReplicaSet  3m53s (x2 over 39m)  deployment-controller  Scaled up replica set nginx-69576c95db to 2
  Normal  ScalingReplicaSet  3m53s                deployment-controller  Scaled down replica set nginx-c7598c4c to 1
  Normal  ScalingReplicaSet  3m52s                deployment-controller  Scaled down replica set nginx-c7598c4c to 0
  Normal  ScalingReplicaSet  42s (x2 over 31m)    deployment-controller  Scaled up replica set nginx-c7598c4c to 1
  Normal  ScalingReplicaSet  40s (x2 over 31m)    deployment-controller  Scaled down replica set nginx-69576c95db to 1
  Normal  ScalingReplicaSet  40s (x2 over 31m)    deployment-controller  Scaled up replica set nginx-c7598c4c to 2
  Normal  ScalingReplicaSet  38s (x2 over 31m)    deployment-controller  Scaled down replica set nginx-69576c95db to 0</code></pre>
        <!-- /code/ -->
      </li>
      <li>deploymentの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete deployment nginx
deployment.apps "nginx" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>deployment削除の確認
        <!-- code -->
        <pre class="pre"><code># kubectl get deployment
No resources found in default namespace.</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h5 class="h5_title">Service作成</h5>

    <ol>
      <li>nginxという名前のポッドを作成、ポート80を公開
        <!-- code -->
        <pre class="pre"><code># kubectl run nginx --image=nginx --restart=Never --labels=app=v1
service/nginx created
pod/nginx created</code></pre>
        <!-- /code/ -->
      </li>
      <li>nginx serviceとエンドポイントのIP確認
        <!-- code -->
        <pre class="pre"><code># kubectl get service nginx
NAME    TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)   AGE
nginx   ClusterIP   10.96.18.42   &lt;none&gt;        80/TCP    90s</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl get ep
NAME         ENDPOINTS         AGE
kubernetes   172.18.0.3:6443   3h46m
nginx        10.244.3.7:80     2m33s</code></pre>
        <!-- /code/ -->
      </li>
      <li>busybox podを作成し、busyboxコンテナーからwgetコマンドでnginx serviceを経由したアクセス確認
        <!-- code -->
        <pre class="pre"><code># kubectl run busybox --image=busybox --restart=Never --rm -it /bin/sh
If you don't see a command prompt, try pressing enter.
/ #　wget -O- 10.96.18.42
Connecting to 10.96.18.42 (10.96.18.42:80)
writing to stdout
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href="http://nginx.org/"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href="http://nginx.com/"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
-                    100% |*************************************************************************************************************|   612  0:00:00 ETA
written to stdout
/ #　exit</code></pre>
        <!-- /code/ -->
      </li>
      <li>nginx podとnginx serviceの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete pod nginx
pod "nginx" deleted</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl delete service nginx
service "nginx" deleted</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h5 class="h5_title">configmap作成</h5>

    <ol>
      <li>“var1=docker” “var2=kuberntes”のconfigMap ‘config'を作成
        <!-- code -->
        <pre class="pre"><code># kubectl create configmap config --from-literal=var1=docker --from-literal=var2=kubernetes
configmap/config created</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl get configmap config
NAME     DATA   AGE
config   2      50s</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl get configmap config -o yaml
apiVersion: v1
data:
  var1: docker
  var2: kubernetes
kind: ConfigMap
metadata:
  creationTimestamp: "2020-12-23T06:23:54Z"
  managedFields:
  - apiVersion: v1
    fieldsType: FieldsV1
    fieldsV1:
      f:data:
        .: {}
        f:var1: {}
        f:var2: {}
    manager: kubectl-create
    operation: Update
    time: "2020-12-23T06:23:54Z"
  name: config
  namespace: default
  resourceVersion: "45693"
  selfLink: /api/v1/namespaces/default/configmaps/config
  uid: 27ec0744-4be0-4e9c-89bb-e71078fc9f9f</code></pre>
        <!-- /code/ -->
      </li>
      <li>configMap ’config’ をenv変数としてnginx podにロード
        <!-- code -->
        <pre
          class="pre"><code># kubectl run --restart=Never nginx --image=nginx -o yaml --dry-run=client > nginx_configmap.yaml</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre
          class="pre"><code># vim nginx_configmap.yaml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    run: nginx
  name: nginx
spec:
  containers:
  - image: nginx
    imagePullPolicy: IfNotPresent
    name: nginx
    resources: {}
    envFrom:
    - configMapRef:
        name: config
  dnsPolicy: ClusterFirst
  restartPolicy: Never
status: {}
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx Podの作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f nginx_configmap.yaml
pod/nginx created</code></pre>
        <!-- /code/ -->
      </li>
      <li>環境変数が読み込まれていることを確認 ※var1=docker var2=kubernetesが表示される
        <!-- code -->
        <pre class="pre"><code># kubectl exec -it nginx -- env
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
HOSTNAME=nginx
NGINX_VERSION=1.19.6
NJS_VERSION=0.5.0
PKG_RELEASE=1~buster
KUBERNETES_PORT=tcp://10.96.0.1:443
KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443
KUBERNETES_PORT_443_TCP_PROTO=tcp
KUBERNETES_PORT_443_TCP_PORT=443
KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1
KUBERNETES_SERVICE_HOST=10.96.0.1
KUBERNETES_SERVICE_PORT=443
KUBERNETES_SERVICE_PORT_HTTPS=443
TERM=xterm
HOME=/root</code></pre>
        <!-- /code/ -->
      </li>
      <li>Nginx podの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete -f nginx_configmap.yaml
pod "nginx" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>削除されたことを確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod
No resources found in default namespace.</code></pre>
        <!-- /code/ -->
      </li>
      <li>configmapの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete configmap config
configmap "config" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>削除されたことを確認
        <!-- code -->
        <pre class="pre"><code># kubectl get configmap
No resources found in default namespace.</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h5 class="h5_title">Multi-container Podの作成</h5>

    <ol>
      <li>
        <p>busyboxイメージを利用して “echo Hello, Docker & Kubernetes !!; sleep 2400”というコマンドを実行する、2つのコンテナーを内包するPodを作成します。
          2番目のコンテナーに接続して「ls」を実行してみましょう。
        </p>multi.yamlを作成
        <!-- code -->
        <pre
          class="pre"><code># kubectl run hello --image=busybox --restart=Never -o yaml --dry-run=client -- /bin/sh -c 'echo Hello, Docker & Kubernetes !!;sleep 2400' > multi.yaml</code></pre>
        <!-- /code/ -->
      </li>
      <li>2つ目のコンテナーを追記
        <!-- code -->
        <pre
          class="pre"><code># vim multi.yaml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    run: busybox
  name: busybox
spec:
  containers:
  - args:
    - /bin/sh
    - -c
    - echo Hello, Docker & Kubernetes !!;sleep 2400
    image: busybox
    name: hello
    resources: {}
  - args:
    - /bin/sh
    - -c
    - echo Hello, Docker & Kubernetes !!;sleep 2400
    image: busybox
    name: hello2
  dnsPolicy: ClusterFirst
  restartPolicy: Never
status: {}
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------</code></pre>
        <!-- /code/ -->
      </li>
      <li>Pod作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f multi.yaml
pod/hello created</code></pre>
        <!-- /code/ -->

        <!-- code -->
        <pre class="pre"><code># kubectl get pod
NAME    READY   STATUS    RESTARTS   AGE
hello   2/2     Running   0          14s</code></pre>
        <!-- /code/ -->
      </li>
      <li>2つ目のコンテナーにアクセス
        <!-- code -->
        <pre class="pre"><code># kubectl exec -it hello -c hello2 -- /bin/sh
/ # ls
bin   dev   etc   home  proc  root  sys   tmp   usr   var
/ # exit</code></pre>
        <!-- /code/ -->
      </li>
      <li>Podの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete pod hello
pod "hello" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>削除されたことを確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod
No resources found in default namespace.</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h5 class="h5_title">WordPress環境の構築</h5>

    <h4 class="h4_title">Secretの作成</h4>

    <ol>
      <li>データベースのパスワードを格納する Kubernetes シークレットを作成
        <!-- code -->
        <pre class="pre"><code># kubectl create secret generic mysql --from-literal=password=JkdJkd123@@@
secret/mysql created</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h4 class="h4_title">MySQLとWordPressのPersistentVolumeとPersistentVolumeClaimの作成</h4>

    <ol>
      <li>「mysql-pv.yml」の作成
        <!-- code -->
        <pre
          class="pre"><code># vim mysql-pv.yml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: v1
kind: PersistentVolume
metadata:
  name: mysql-pv
  labels:
    type: local
spec:
  storageClassName: mysql
  capacity:
    storage: 3Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: /data/mysql
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------</code></pre>
        <!-- /code/ -->
      </li>
      <li>「mysql-pvc.yml」の作成
        <!-- code -->
        <pre
          class="pre"><code># vim mysql-pvc.yml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mysql-pvc
  labels:
    app: wordpress
    tier: mysql
spec:
  storageClassName: mysql
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------</code></pre>
        <!-- /code/ -->
      </li>
      <li>pvの作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f mysql-pv.yml
persistentvolume/mysql-pv created</code></pre>
        <!-- /code/ -->
      </li>
      <li>pvcの作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f mysql-pvc.yml
persistentvolumeclaim/mysql-pvc created</code></pre>
        <!-- /code/ -->
      </li>
      <li>「wordpress-pv.yml」の作成
        <!-- code -->
        <pre
          class="pre"><code># vim wordpress-pv.yml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: v1
kind: PersistentVolume
metadata:
  name: wordpress-pv
  labels:
    type: local
spec:
  storageClassName: wordpress
  capacity:
    storage: 3Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: /data/wordpress
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------</code></pre>
        <!-- /code/ -->
      </li>
      <li>「mysql-pvc.yml」の作成
        <!-- code -->
        <pre
          class="pre"><code># vim mysql-pvc.yml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: wordpress-pvc
  labels:
    app: wordpress
    tier: wordpress
spec:
  storageClassName: wordpress
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------</code></pre>
        <!-- /code/ -->
      </li>
      <li>pvの作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f wordpress-pv.yml
persistentvolume/wordpress-pv created</code></pre>
        <!-- /code/ -->
      </li>
      <li>pvcの作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f wordpress-pvc.yml
persistentvolumeclaim/wordpress-pvc created</code></pre>
        <!-- /code/ -->
      </li>
      <li>pvcの作成
        <!-- code -->
        <pre class="pre"><code># kubectl get pvc,pv
NAME                            CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                   STORAGECLASS   REASON   AGE
persistentvolume/mysql-pv       3Gi        RWO            Retain           Bound    default/mysql-pvc       mysql                   111s
persistentvolume/wordpress-pv   3Gi        RWO            Retain           Bound    default/wordpress-pvc   wordpress               14s

NAME                                  STATUS   VOLUME         CAPACITY   ACCESS MODES   STORAGECLASS   AGE
persistentvolumeclaim/mysql-pvc       Bound    mysql-pv       3Gi        RWO            mysql          86s
persistentvolumeclaim/wordpress-pvc   Bound    wordpress-pv   3Gi        RWO            wordpress      5s</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h4 class="h4_title">MySQLのDeploymentとServiceの作成</h4>

    <ol>
      <li>「mysql.yml」の作成
        <!-- code -->
        <pre class="pre"><code># vim mysql.yml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mysql
  labels:
    app: mysql
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mysql
  template:
    metadata:
      labels:
        app: mysql
    spec:
      containers:
        - image: mysql:5.6
          name: mysql
          env:
            - name: MYSQL_ROOT_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: mysql
                  key: password
          ports:
            - containerPort: 3306
              name: mysql
          volumeMounts:
            - name: mysql-local-storage
              mountPath: /var/lib/mysql
      volumes:
        - name: mysql-local-storage
          persistentVolumeClaim:
            claimName: mysql-pvc
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------
Esc + :wq</code></pre>
        <!-- /code/ -->
      </li>
      <li>MySQLのdeploymentの作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f mysql.yml
deployment.apps/mysql created</code></pre>
        <!-- /code/ -->
      </li>
      <li>podの確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod -l app=mysql
NAME                    READY   STATUS    RESTARTS   AGE
mysql-9c9dc94f5-bh976   1/1     Running   0          36s</code></pre>
        <!-- /code/ -->
      </li>
      <li>「mysql-service.yml」の作成
        <!-- code -->
        <pre class="pre"><code># vim mysql-service.yml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: v1
kind: Service
metadata:
  name: mysql
  labels:
    app: mysql
spec:
  type: ClusterIP
  ports:
    - port: 3306
  selector:
    app: mysql
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------
Esc + :wq</code></pre>
        <!-- /code/ -->
      </li>
      <li>Serviceの作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f mysql-service.yml
service/mysql created</code></pre>
        <!-- /code/ -->
      </li>
      <li>Serviceの確認
        <!-- code -->
        <pre class="pre"><code># kubectl get svc -l app=mysql
NAME    TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE
mysql   ClusterIP   10.96.148.247   &lt;none&gt;        3306/TCP   15s</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h4 class="h4_title">WordPressのDeploymentとServiceの作成</h4>

    <ol>
      <li>「wordpress.yml」の作成
        <!-- code -->
        <pre class="pre"><code># vim wordpress.yml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: apps/v1
kind: Deployment
metadata:
  name: wordpress
  labels:
    app: wordpress
spec:
  replicas: 1
  selector:
    matchLabels:
      app: wordpress
  template:
    metadata:
      labels:
        app: wordpress
    spec:
      containers:
        - image: wordpress
          name: wordpress
          env:
          - name: WORDPRESS_DB_HOST
            value: mysql:3306
          - name: WORDPRESS_DB_PASSWORD
            valueFrom:
              secretKeyRef:
                name: mysql
                key: password
          ports:
            - containerPort: 80
              name: wordpress
          volumeMounts:
            - name: wordpress-local-storage
              mountPath: /var/www/html
      volumes:
        - name: wordpress-local-storage
          persistentVolumeClaim:
            claimName: wordpress-pvc
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------
Esc + :wq</code></pre>
        <!-- /code/ -->
      </li>
      <li>WordPressのdeploymentの作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f wordpress.yml
deployment.apps/wordpress created</code></pre>
        <!-- /code/ -->
      </li>
      <li>podの確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod -l app=wordpress
NAME                         READY   STATUS    RESTARTS   AGE
wordpress-6b9dd8f4c5-bh46k   1/1     Running   0          118s</code></pre>
        <!-- /code/ -->
      </li>
      <li>「wordpress-service.yml」の作成
        <!-- code -->
        <pre class="pre"><code># vim wordpress-service.yml
--------------------------------------------------以下の内容をコピー&ペースト-----------------------------------------------------
apiVersion: v1
kind: Service
metadata:
  labels:
    app: wordpress
  name: wordpress
spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: 80
      nordPort: 30008
      protocol: TCP
  selector:
    app: wordpress
--------------------------------------------------[Esc + :wq]で保存終了します。--------------------------------------------------
Esc + :wq</code></pre>
        <!-- /code/ -->
      </li>
      <li>Serviceの作成
        <!-- code -->
        <pre class="pre"><code># kubectl create -f wordpress-service.yml
service/wordpress created</code></pre>
        <!-- /code/ -->
      </li>
      <li>Serviceの確認
        <!-- code -->
        <pre class="pre"><code># kubectl get svc -l app=wordpress
NAME        TYPE       CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE
wordpress   NodePort   10.96.153.116   &lt;none&gt;        80:30008/TCP   55ms</code></pre>
        <!-- /code/ -->
        <!-- code -->
        <pre class="pre"><code># kubectl run busybox --image=busybox --restart=Never -it --rm -- sh
If you don't see a command prompt, try pressing enter.
/ # wget -O- 10.96.153.116
Connecting to 10.96.153.116 (10.96.153.116:80)
Connecting to 10.96.153.116 (10.96.153.116:80)
writing to stdout
&lt;!DOCTYPE html&gt;
&lt;html lang="en-US" xml:lang="en-US"&gt;
&lt;head&gt;
        &lt;meta name="viewport" content="width=device-width" /&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
        &lt;meta name="robots" content="noindex,nofollow" /&gt;
        &lt;title&gt;WordPress &rsaquo; Installation&lt;/title&gt;
        &lt;link rel='stylesheet' id='dashicons-css'  href='http://10.96.153.116/wp-includes/css/dashicons.min.css?ver=5.6' type='text/css' media='all' /&gt;
&lt;link rel='stylesheet' id='buttons-css'  href='http://10.96.153.116/wp-includes/css/buttons.min.css?ver=5.6' type='text/css' media='all' /&gt;
&lt;link rel='stylesheet' id='forms-css'  href='http://10.96.153.116/wp-admin/css/forms.min.css?ver=5.6' type='text/css' media='all' /&gt;
&lt;link rel='stylesheet' id='l10n-css'  href='http://10.96.153.116/wp-admin/css/l10n.min.css?ver=5.6' type='text/css' media='all' /&gt;
&lt;link rel='stylesheet' id='install-css'  href='http://10.96.153.116/wp-admin/css/install.min.css?ver=5.6' type='text/css' media='all' /&gt;
&lt;/head&gt;
&lt;body class="wp-core-ui language-chooser"&gt;
&lt;p id="logo"&gt;WordPress&lt;/p&gt;

        &lt;form id="setup" method="post" action="?step=1"&gt;&lt;label class='screen-reader-text' for='language'&gt;Select a default language&lt;/label&gt;
&lt;select size='14' name='language' id='language'&gt;
&lt;option value="" lang="en" selected="selected" data-continue="Continue" data-installed="1"&gt;English (United States)&lt;/option&gt;
&lt;option value="af" lang="af" data-continue="Gaan voort"&gt;Afrikaans&lt;/option&gt;
&lt;option value="ar" lang="ar" data-continue="????????"&gt;???????&lt;/option&gt;
&lt;option value="ary" lang="ar" data-continue="????????"&gt;??????? ????????&lt;/option&gt;
&lt;option value="as" lang="as" data-continue="Continue"&gt;???????&lt;/option&gt;
&lt;option value="az" lang="az" data-continue="Davam"&gt;Az?rbaycan dili&lt;/option&gt;
&lt;option value="azb" lang="az" data-continue="Continue"&gt;????? ?????????&lt;/option&gt;
&lt;option value="bel" lang="be" data-continue="Працягнуць"&gt;Беларуская мова&lt;/option&gt;
&lt;option value="bg_BG" lang="bg" data-continue="Продължение"&gt;Български&lt;/option&gt;
&lt;option value="bn_BD" lang="bn" data-continue="????? ??."&gt;?????&lt;/option&gt;
&lt;option value="bo" lang="bo" data-continue="????????"&gt;???????&lt;/option&gt;
&lt;option value="bs_BA" lang="bs" data-continue="Nastavi"&gt;Bosanski&lt;/option&gt;
&lt;option value="ca" lang="ca" data-continue="Continua"&gt;Catala&lt;/option&gt;
&lt;option value="ceb" lang="ceb" data-continue="Padayun"&gt;Cebuano&lt;/option&gt;
&lt;option value="cs_CZ" lang="cs" data-continue="Pokra?ovat"&gt;?e?tina&lt;/option&gt;
&lt;option value="cy" lang="cy" data-continue="Parhau"&gt;Cymraeg&lt;/option&gt;
&lt;option value="da_DK" lang="da" data-continue="Forts&#230;t"&gt;Dansk&lt;/option&gt;
&lt;option value="de_DE_formal" lang="de" data-continue="Fortfahren"&gt;Deutsch (Sie)&lt;/option&gt;
&lt;option value="de_CH_informal" lang="de" data-continue="Weiter"&gt;Deutsch (Schweiz, Du)&lt;/option&gt;
&lt;option value="de_DE" lang="de" data-continue="Fortfahren"&gt;Deutsch&lt;/option&gt;
&lt;option value="de_AT" lang="de" data-continue="Weiter"&gt;Deutsch (Osterreich)&lt;/option&gt;
&lt;option value="de_CH" lang="de" data-continue="Fortfahren"&gt;Deutsch (Schweiz)&lt;/option&gt;
&lt;option value="dsb" lang="dsb" data-continue="Dalej"&gt;Dolnoserb??ina&lt;/option&gt;
&lt;option value="dzo" lang="dz" data-continue="Continue"&gt;??????&lt;/option&gt;
&lt;option value="el" lang="el" data-continue="Συν?χεια"&gt;Ελληνικ?&lt;/option&gt;
&lt;option value="en_CA" lang="en" data-continue="Continue"&gt;English (Canada)&lt;/option&gt;
&lt;option value="en_ZA" lang="en" data-continue="Continue"&gt;English (South Africa)&lt;/option&gt;
&lt;option value="en_GB" lang="en" data-continue="Continue"&gt;English (UK)&lt;/option&gt;
&lt;option value="en_AU" lang="en" data-continue="Continue"&gt;English (Australia)&lt;/option&gt;
&lt;option value="en_NZ" lang="en" data-continue="Continue"&gt;English (New Zealand)&lt;/option&gt;
&lt;option value="eo" lang="eo" data-continue="Da?rigi"&gt;Esperanto&lt;/option&gt;
&lt;option value="es_MX" lang="es" data-continue="Continuar"&gt;Espanol de Mexico&lt;/option&gt;
&lt;option value="es_CO" lang="es" data-continue="Continuar"&gt;Espanol de Colombia&lt;/option&gt;
&lt;option value="es_VE" lang="es" data-continue="Continuar"&gt;Espanol de Venezuela&lt;/option&gt;
&lt;option value="es_ES" lang="es" data-continue="Continuar"&gt;Espanol&lt;/option&gt;
&lt;option value="es_EC" lang="es" data-continue="Continuar"&gt;Espanol de Ecuador&lt;/option&gt;
&lt;option value="es_CL" lang="es" data-continue="Continuar"&gt;Espanol de Chile&lt;/option&gt;
&lt;option value="es_PE" lang="es" data-continue="Continuar"&gt;Espanol de Peru&lt;/option&gt;
&lt;option value="es_CR" lang="es" data-continue="Continuar"&gt;Espanol de Costa Rica&lt;/option&gt;
&lt;option value="es_PR" lang="es" data-continue="Continuar"&gt;Espanol de Puerto Rico&lt;/option&gt;
&lt;option value="es_UY" lang="es" data-continue="Continuar"&gt;Espanol de Uruguay&lt;/option&gt;
&lt;option value="es_GT" lang="es" data-continue="Continuar"&gt;Espanol de Guatemala&lt;/option&gt;
&lt;option value="es_AR" lang="es" data-continue="Continuar"&gt;Espanol de Argentina&lt;/option&gt;
&lt;option value="et" lang="et" data-continue="Jatka"&gt;Eesti&lt;/option&gt;
&lt;option value="eu" lang="eu" data-continue="Jarraitu"&gt;Euskara&lt;/option&gt;
&lt;option value="fa_IR" lang="fa" data-continue="?????"&gt;?????&lt;/option&gt;
&lt;option value="fi" lang="fi" data-continue="Jatka"&gt;Suomi&lt;/option&gt;
&lt;option value="fr_FR" lang="fr" data-continue="Continuer"&gt;Francais&lt;/option&gt;
&lt;option value="fr_BE" lang="fr" data-continue="Continuer"&gt;Francais de Belgique&lt;/option&gt;
&lt;option value="fr_CA" lang="fr" data-continue="Continuer"&gt;Francais du Canada&lt;/option&gt;
&lt;option value="fur" lang="fur" data-continue="Continue"&gt;Friulian&lt;/option&gt;
&lt;option value="gd" lang="gd" data-continue="Lean air adhart"&gt;Gaidhlig&lt;/option&gt;
&lt;option value="gl_ES" lang="gl" data-continue="Continuar"&gt;Galego&lt;/option&gt;
&lt;option value="gu" lang="gu" data-continue="???? ??????"&gt;???????&lt;/option&gt;
&lt;option value="haz" lang="haz" data-continue="?????"&gt;????? ??&lt;/option&gt;
&lt;option value="he_IL" lang="he" data-continue="??????"&gt;????????&lt;/option&gt;
&lt;option value="hi_IN" lang="hi" data-continue="????"&gt;??????&lt;/option&gt;
&lt;option value="hr" lang="hr" data-continue="Nastavi"&gt;Hrvatski&lt;/option&gt;
&lt;option value="hsb" lang="hsb" data-continue="Dale"&gt;Hornjoserb??ina&lt;/option&gt;
&lt;option value="hu_HU" lang="hu" data-continue="Tovabb"&gt;Magyar&lt;/option&gt;
&lt;option value="hy" lang="hy" data-continue="??????????"&gt;???????&lt;/option&gt;
&lt;option value="id_ID" lang="id" data-continue="Lanjutkan"&gt;Bahasa Indonesia&lt;/option&gt;
&lt;option value="is_IS" lang="is" data-continue="Afram"&gt;Islenska&lt;/option&gt;
&lt;option value="it_IT" lang="it" data-continue="Continua"&gt;Italiano&lt;/option&gt;
&lt;option value="ja" lang="ja" data-continue="続ける"&gt;日本語&lt;/option&gt;
&lt;option value="jv_ID" lang="jv" data-continue="Nutugne"&gt;Basa Jawa&lt;/option&gt;
&lt;option value="ka_GE" lang="ka" data-continue="??????????"&gt;???????&lt;/option&gt;
&lt;option value="kab" lang="kab" data-continue="Continuer"&gt;Taqbaylit&lt;/option&gt;
&lt;option value="kk" lang="kk" data-continue="Жал?астыру"&gt;?аза? т?л?&lt;/option&gt;
&lt;option value="km" lang="km" data-continue="????"&gt;?????????&lt;/option&gt;
&lt;option value="kn" lang="kn" data-continue="??????????"&gt;?????&lt;/option&gt;
&lt;option value="ko_KR" lang="ko" data-continue="??"&gt;???&lt;/option&gt;
&lt;option value="ckb" lang="ku" data-continue="?????????? ???"&gt;??????&lt;/option&gt;
&lt;option value="lo" lang="lo" data-continue="???"&gt;???????&lt;/option&gt;
&lt;option value="lt_LT" lang="lt" data-continue="T?sti"&gt;Lietuvi? kalba&lt;/option&gt;
&lt;option value="lv" lang="lv" data-continue="Turpin?t"&gt;Latvie?u valoda&lt;/option&gt;
&lt;option value="mk_MK" lang="mk" data-continue="Продолжи"&gt;Македонски ?азик&lt;/option&gt;
&lt;option value="ml_IN" lang="ml" data-continue="??????"&gt;??????&lt;/option&gt;
&lt;option value="mn" lang="mn" data-continue="?ргэлжл??лэх"&gt;Монгол&lt;/option&gt;
&lt;option value="mr" lang="mr" data-continue="???? ????"&gt;?????&lt;/option&gt;
&lt;option value="ms_MY" lang="ms" data-continue="Teruskan"&gt;Bahasa Melayu&lt;/option&gt;
&lt;option value="my_MM" lang="my" data-continue="??????????????????"&gt;?????&lt;/option&gt;
&lt;option value="nb_NO" lang="nb" data-continue="Fortsett"&gt;Norsk bokmal&lt;/option&gt;
&lt;option value="ne_NP" lang="ne" data-continue="?????????? "&gt;??????&lt;/option&gt;
&lt;option value="nl_NL" lang="nl" data-continue="Doorgaan"&gt;Nederlands&lt;/option&gt;
&lt;option value="nl_BE" lang="nl" data-continue="Doorgaan"&gt;Nederlands (Belgie)&lt;/option&gt;
&lt;option value="nl_NL_formal" lang="nl" data-continue="Doorgaan"&gt;Nederlands (Formeel)&lt;/option&gt;
&lt;option value="nn_NO" lang="nn" data-continue="Hald fram"&gt;Norsk nynorsk&lt;/option&gt;
&lt;option value="oci" lang="oc" data-continue="Contunhar"&gt;Occitan&lt;/option&gt;
&lt;option value="pa_IN" lang="pa" data-continue="???? ????"&gt;??????&lt;/option&gt;
&lt;option value="pl_PL" lang="pl" data-continue="Kontynuuj"&gt;Polski&lt;/option&gt;
&lt;option value="ps" lang="ps" data-continue="????"&gt;????&lt;/option&gt;
&lt;option value="pt_PT" lang="pt" data-continue="Continuar"&gt;Portugues&lt;/option&gt;
&lt;option value="pt_BR" lang="pt" data-continue="Continuar"&gt;Portugues do Brasil&lt;/option&gt;
&lt;option value="pt_PT_ao90" lang="pt" data-continue="Continuar"&gt;Portugues (AO90)&lt;/option&gt;
&lt;option value="pt_AO" lang="pt" data-continue="Continuar"&gt;Portugues de Angola&lt;/option&gt;
&lt;option value="rhg" lang="rhg" data-continue="Continue"&gt;Ruainga&lt;/option&gt;
&lt;option value="ro_RO" lang="ro" data-continue="Continu?"&gt;Roman?&lt;/option&gt;
&lt;option value="ru_RU" lang="ru" data-continue="Продолжить"&gt;Русский&lt;/option&gt;
&lt;option value="sah" lang="sah" data-continue="Сал?аа"&gt;Сахалыы&lt;/option&gt;
&lt;option value="snd" lang="sd" data-continue="???? ???"&gt;????&lt;/option&gt;
&lt;option value="si_LK" lang="si" data-continue="????? ????? ????"&gt;?????&lt;/option&gt;
&lt;option value="sk_SK" lang="sk" data-continue="Pokra?ova?"&gt;Sloven?ina&lt;/option&gt;
&lt;option value="skr" lang="skr" data-continue="???? ????"&gt;???????&lt;/option&gt;
&lt;option value="sl_SI" lang="sl" data-continue="Nadaljujte"&gt;Sloven??ina&lt;/option&gt;
&lt;option value="sq" lang="sq" data-continue="Vazhdo"&gt;Shqip&lt;/option&gt;
&lt;option value="sr_RS" lang="sr" data-continue="Настави"&gt;Српски ?език&lt;/option&gt;
&lt;option value="sv_SE" lang="sv" data-continue="Fortsatt"&gt;Svenska&lt;/option&gt;
&lt;option value="sw" lang="sw" data-continue="Endelea"&gt;Kiswahili&lt;/option&gt;
&lt;option value="szl" lang="szl" data-continue="K?ntynuowa?"&gt;?l?nsk? g?dka&lt;/option&gt;
&lt;option value="ta_IN" lang="ta" data-continue="????????"&gt;?????&lt;/option&gt;
&lt;option value="te" lang="te" data-continue="??????????"&gt;??????&lt;/option&gt;
&lt;option value="th" lang="th" data-continue="?????"&gt;???&lt;/option&gt;
&lt;option value="tl" lang="tl" data-continue="Magpatuloy"&gt;Tagalog&lt;/option&gt;
&lt;option value="tr_TR" lang="tr" data-continue="Devam"&gt;Turkce&lt;/option&gt;
&lt;option value="tt_RU" lang="tt" data-continue="д?вам ит?"&gt;Татар теле&lt;/option&gt;
&lt;option value="tah" lang="ty" data-continue="Continue"&gt;Reo Tahiti&lt;/option&gt;
&lt;option value="ug_CN" lang="ug" data-continue="?????????????"&gt;????????&lt;/option&gt;
&lt;option value="uk" lang="uk" data-continue="Продовжити"&gt;Укра?нська&lt;/option&gt;
&lt;option value="ur" lang="ur" data-continue="???? ?????"&gt;????&lt;/option&gt;
&lt;option value="uz_UZ" lang="uz" data-continue="Продолжить"&gt;O‘zbekcha&lt;/option&gt;
&lt;option value="vi" lang="vi" data-continue="Ti?p t?c"&gt;Ti?ng Vi?t&lt;/option&gt;
&lt;option value="zh_TW" lang="zh" data-continue="繼續"&gt;繁體中文&lt;/option&gt;
&lt;option value="zh_HK" lang="zh" data-continue="繼續"&gt;香港中文版 &lt;/option&gt;
&lt;option value="zh_CN" lang="zh" data-continue="??"&gt;?体中文&lt;/option&gt;
&lt;/select&gt;
&lt;p class="step"&gt;&lt;span class="spinner"&gt;&lt;/span&gt;&lt;input id="language-continue" type="submit" class="button button-primary button-large" value="Continue" /&gt;&lt;/p&gt;&lt;/-                    12151 --:--:-- ETAweblog_title'); if (t){ t.focus(); }&lt;/script&gt;
        &lt;script type='text/javascript' src='http://10.96.153.116/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'&gt;&lt;/script&gt;
&lt;script type='text/javascript' src='http://10.96.153.116/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'&gt;&lt;/script&gt;
&lt;script type='text/javascript' src='http://10.96.153.116/wp-admin/js/language-chooser.min.js?ver=5.6' id='language-chooser-js'&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
jQuery( function( $ ) {
        $( '.hide-if-no-js' ).removeClass( 'hide-if-no-js' );
} );
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
-                    100% |*************************************************************************************************************| 12756  0:00:00 ETA
written to stdout
/ # exit
pod "busybox" deleted</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h4 class="h4_title">Podの自動修復（セルフヒーリング）</h4>

    <ol>
      <li>WordPressのPod状況を確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod
NAME                         READY   STATUS    RESTARTS   AGE
mysql-9c9dc94f5-bh976        1/1     Running   0          78m
wordpress-6b9dd8f4c5-bh46k   1/1     Running   0          73m</code></pre>
        <!-- /code/ -->
      </li>
      <li>WordPressのPodを削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete pod -l app=wordpress
pod "wordpress-6b9dd8f4c5-bh46k" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>WordPressのPod名の確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod
NAME                         READY   STATUS    RESTARTS   AGE
mysql-9c9dc94f5-bh976        1/1     Running   0          79m
wordpress-6b9dd8f4c5-26w8h   1/1     Running   0          63s</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <h4 class="h4_title">クリーンアップ</h4>

    <ol>
      <li>deploymentの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete -f wordpress.yml
deployment.apps "wordpress" deleted</code></pre>
        <pre class="pre"><code># kubectl delete -f mysql.yml
deployment.apps "mysql" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>serviceを削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete -f wordpress-service.yml
service "wordpress" deleted</code></pre>
        <pre class="pre"><code># kubectl delete -f mysql-service.yml
service "mysql" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>pvcの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete -f wordpress-pvc.yml
persistentvolumeclaim "wordpress-pvc" deleted</code></pre>
        <pre class="pre"><code># kubectl delete -f mysql-pvc.yml
persistentvolumeclaim "mysql-pvc" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>pvの削除
        <!-- code -->
        <pre class="pre"><code># kubectl delete -f wordpress-pv.yml
persistentvolume "wordpress-pv" deleted</code></pre>
        <pre class="pre"><code># kubectl delete -f mysql-pv.yml
persistentvolume "mysql-pv" deleted</code></pre>
        <!-- /code/ -->
      </li>
      <li>podの確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pod -l app=wordpress
No resources found in default namespace.</code></pre>
        <pre class="pre"><code># kubectl get pod -l app=mysql
No resources found in default namespace.</code></pre>
        <!-- /code/ -->
      </li>
      <li>serviceの確認
        <!-- code -->
        <pre class="pre"><code># kubectl get svc -l app=wordpress
No resources found in default namespace.</code></pre>
        <pre class="pre"><code># kubectl get svc -l app=mysql
No resources found in default namespace.</code></pre>
        <!-- /code/ -->
      </li>
      <li>pv,pvcの確認
        <!-- code -->
        <pre class="pre"><code># kubectl get pvc,pv
No resources found</code></pre>
        <!-- /code/ -->
      </li>
      <li>DeploymentとServiceの確認
        <!-- code -->
        <pre class="pre"><code># kubectl get deployment
No resources found in default namespace.</code></pre>
        <pre class="pre"><code># kubectl get service
NAME         TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
kubernetes   ClusterIP   10.96.0.1    &lt;none&gt;        443/TCP   128m</code></pre>
        <!-- /code/ -->
      </li>
      <li>Secretの削除と確認
        <!-- code -->
        <pre class="pre"><code># kubectl delete secret mysql
secret "mysql" deleted</code></pre>
        <pre class="pre"><code># kubectl get secret
NAME                  TYPE                                  DATA   AGE
default-token-tl72t   kubernetes.io/service-account-token   3      128m</code></pre>
        <!-- /code/ -->
      </li>
      <li>kindクラスタの削除
        <!-- code -->
        <pre class="pre"><code># kind delete clusters k8s
Deleted clusters: ["k8s"]</code></pre>
        <!-- /code/ -->
      </li>
    </ol>

    <p class="text_align_center"><a href="../kouki.html">後期演習トップへ戻る</a></p>

    <p class="text_align_center"><a href="../index.html">トップへ戻る</a></p>

  </div>

  <hr>

  <footer id="footer">
    <footer-content></footer-content>
  </footer>

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="../js/bootstrap.min.js"></script>
  <script src="../js/main.js"></script>
</body>

</html>